version: '3.8'

services:
 postgres-library:
  image: postgres:latest
  container_name: library-postgres
  environment:
   POSTGRES_DB: library
   POSTGRES_USER: postgres
   POSTGRES_PASSWORD: postgres
  ports:
   - "5438:5432"
  volumes:
   - postgres_library_data:/var/lib/postgresql/data
  networks:
   - library-net
 
 postgres-reports:
  image: postgres:latest
  container_name: reports-postgres
  environment:
   POSTGRES_DB: reports
   POSTGRES_USER: postgres
   POSTGRES_PASSWORD: postgres
  ports:
   - "5439:5432"
  volumes:
   - postgres_reports_data:/var/lib/postgresql/data
  networks:
   - library-net
   
 redis:
  image: redis:latest
  container_name: library-redis
  ports:
   - "6380:6379"
  volumes:
   - redis_data:/data
  command: redis-server --appendonly yes
  networks:
   - library-net
 
 redisinsight:
  image: redis/redisinsight:latest
  container_name: library-redisinsight
  ports:
   - "5540:5540"
  volumes:
   - redisinsight_data:/data
  networks:
   - library-net
 
 minio:
  image: minio/minio
  container_name: library-minio
  ports:
   - "9003:9000"
   - "9004:9001"
  environment:
   MINIO_ROOT_USER: AKIAIOSFODNN7EXAMPLE
   MINIO_ROOT_PASSWORD: wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
  volumes:
   - minio_data:/data
  command: server /data --console-address ":9001"
  networks:
   - library-net
   
 rabbitmq:
  image: rabbitmq:4-management
  container_name: library-rabbitmq
  restart: unless-stopped
  environment:
   RABBITMQ_DEFAULT_USER: guest
   RABBITMQ_DEFAULT_PASS: guest
  ports:
   - "5672:5672"
   - "15672:15672"
  volumes:
   - rabbitmq_data:/var/lib/rabbitmq
  networks:
   - library-net

volumes:
 postgres_library_data:
 postgres_reports_data:
 redis_data:
 redisinsight_data:
 minio_data:
 rabbitmq_data:

networks:
 library-net:
  driver: bridge
